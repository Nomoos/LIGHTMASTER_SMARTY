<?phprequire_once 'core.php';include_once '../includes/lang_switch.php';//BOF-overeni$check_user = fetch_assoc(query("SELECT `id`, `uzivatelOpravneni_id` FROM `uzivatel` WHERE `session`='" . session_id() . "'"));if (($check_user['id'] != $_SESSION['user']['id']) OR !isset($_SESSION['user'])) {    session_regenerate_id();    go($setup['adm']['www'] . "?token=" . $setup['request_url_token']);}//EOF-overeni////BOF - automat - automaticke nacitani souboru v IS a jejich TPLif (is_file($setup['adm']['root'] . "/" . $_GET['page'] . "/" . $_GET['page'] . ".php")) {    $page['main']['name'] = $_GET['page'];    $page['main']['php'] = $_GET['page'] . ".php";    $page['main']['tpl'] = "./" . $_GET['page'] . "/" . $_GET['page'] . ".tpl";    $page['sub']['name'] = $_GET['subpage'];    $page['sub']['php'] = $_GET['page'] . "-" . $_GET['subpage'] . ".php";    $page['sub']['tpl'] = "./" . $_GET['page'] . "-" . $_GET['subpage'] . ".tpl";} elseif($_GET['page']=='prazdnaStranka') {    $page['main']['tpl'] = "./includes/".$_GET['page'].".tpl";}else {    go($setup['adm']['www'] . "prazdnaStranka.html");}$smarty->assign("page", $page);//EOF - automat$tpl_main = array(    "administrace" => $setup['root'] . "/templates/");//BOF-moduly|infoif ($_SESSION['user']['admin'] == 2) {    $modul_sql = query("SELECT `id`, `nazev`, `page`, `url`, `icon`, `modul_id`, `zobraz`, `nadpis` FROM `modul` ORDER BY `modul_id`, `poradi`");} else {    $modul_sql = query("            SELECT m.`id`, m.`nazev`, m.`page`, m.`url`, m.`icon`, m.`modul_id`, m.`zobraz`, m.`nadpis`            FROM `uzivatelOpravneni_modul` AS uom            LEFT JOIN `modul` AS m ON(uom.`modul_id` = m.`id`)            WHERE uom.`uzivatelOpravneni_id`='{$_SESSION['user']['perm']}' ORDER BY m.`modul_id`, m.`poradi`");}while ($it = fetch_assoc($modul_sql)) {    if (is_null($it['modul_id'])) {        $modul_tmp[$it['id']] = $it;    } else {        $modul_tmp[$it['modul_id']]['sub'][$it['page']] = $it;    }    $allowModul[] = $it['id'];}if ($modul_tmp) {    foreach ($modul_tmp as $k => $v) {        $modul[$v['page']] = $v;    }    unset($modul_tmp);}$smarty->assign("modul", $modul);//EOF-moduly|info////BOF-povolene modulyif ($_GET['page'] AND $_GET['subpage']) {    $urlModul = $_GET['page'] . "/" . $_GET['subpage'] . ".html";    $activeModul = fetch_assoc(query("SELECT `id`, `modul_id` FROM `modul` WHERE `url`='{$urlModul}'"));    if (!in_array($activeModul['id'], (array) $allowModul) OR !in_array($activeModul['modul_id'], (array) $allowModul)) {        go($setup['adm']['www'] . "prazdnaStranka.html");    }}//EOF-povolene moduly////BOF-variable$variable['boolean'] = array(    "0" => "NE",    "2" => "ANO");$variable['booleanBadge'] = array(    "0" => '<span class="badge badge-danger">NE</span>',    "2" => '<span class="badge badge-success">ANO</span>');$variable['booleanBadgeInverse'] = array(    "0" => '<span class="badge badge-success">NE</span>',    "2" => '<span class="badge badge-danger">ANO</span>');$variable['flag'] = array(    "1" => '',    "2" => '<i class="icon-flag bigger-130 red" title="VysokÃ¡ priorita"></i>');//EOF-variable$smarty->assign("variable", $variable);//EOF-variable?>