<?phpfunction smarty_function_order($params, $template) {    if (empty($params['name'])) {        trigger_error("order: chybí parametr 'name'", E_USER_WARNING);        return;    }    if (empty($params['order_by'])) {        $order_by = $params['name'];    } else {        $order_by = $params['order_by'];    }    if ($params['a_title']) {        $a_title = " dle " . $params['a_title'];    }    if ($params['url_suffix']) {        $url_suffix = $params['url_suffix'];    }    /*$arrow['up'] = '<img src="http://data.advin.cz/icon/silk/1.3/bullet_arrow_up.png">';    $arrow['down'] = '<img src="http://data.advin.cz/icon/silk/1.3/bullet_arrow_down.png">';*/    $arrow['up'] = '<i class="icon-chevron-up bigger-110"></i>';    $arrow['down'] = '<i class="icon-chevron-down bigger-110"></i>';    $href = $_SERVER['REQUEST_URI'];    if (strpos($href, "&order")) {        $position_sort = strpos($href, "&order");    } elseif (strpos($href, "?order")) {        $position_sort = strpos($href, "?order");    }    $active['asc'] = "grey";    $active['desc'] = "grey";    if ($position_sort) {        $order = explode("_", $_GET['order']);        if ($order[0] == $order_by) {            if (end($order) == "asc") {                $active['asc'] = "red";            } elseif (end($order) == "desc") {                $active['desc'] = "red";            }        }        $href = substr($href, 0, $position_sort);    }    if (strpos($href, "?")) {        $href = $href . "&amp;";    } else {        $href = $href . "?";    }    $sorted = '<div><a class="no-underline ' . $active['asc'] . '" href="' . $href . 'order=' . $order_by . '_asc' . $url_suffix . '" title="řadit vzestupně' . $a_title . '">' . $arrow['up'] . '</a></div>        ' . $params['name'] . '            <div><a class="no-underline ' . $active['desc'] . '" href="' . $href . 'order=' . $order_by . '_desc' . $url_suffix . '" title="řadit sestupně' . $a_title . '">' . $arrow['down'] . '</a></div>';    return $sorted;}?>