<?php/** * Smarty plugin * @package Smarty * @subpackage PluginsFunction *//** * Smarty {pagination} function plugin * * Type:     function<br> * Name:     pagination<br> * Date:     Jun 20, 2013 * Purpose:  vytvoreni strankovani * * Params: * <pre> * - page       - (required) - celkovy pocet stranek (pokud neni tato hodnota lze dopocitat z parametru on_page, item) * - on_page    - (optional) - pocet polozek na stranku * - item       - (optional) - celkovy pocet polozek * </pre> * Examples: * <pre> * {pagination page="10"} * {pagination on_page="12" item="55"} * </pre> * * @version 1.0 *  * @author Matez * @param array                    $params   parameters * @param Smarty_Internal_Template $template template object * @return string */function smarty_function_pagination($params, $template) {    //BOF-page - celkovy pocet stranek    if ((empty($params['page']) AND $params['page'] != 0 ) AND empty($params['on_page']) AND empty($params['item'])) {        trigger_error("pagination: chybí parametr 'page' nebo ( 'on_page' a 'item' )", E_USER_WARNING);        return;    } elseif ($params['page']) {        $count['page'] = $params['page'];    } elseif ($params['on_page'] AND $params['item']) {        $count['page'] = ceil($params['item'] / $params['on_page']);    }    //EOF-page    //    //BOF-view - kolik stranek ma byt videt z kazde strany aktivni stranky    if (empty($params['view_page'])) {        $view_page = 3;    } else {        $view_page = $params['view_page'];    }    //EOF-view    //    //BOF-active - aktualni stranka    if (!empty($params['active_page'])) {        $active_page = $params['active_page'];    } elseif ($_GET['strana']) {        $active_page = intval($_GET['strana']);    } else {        $active_page = 1;    }    //EOF-active    //    //BOF-pocitadlo - nastaveni pro generovani stranek    if (($active_page - $view_page) < 2) {        $start_page = 2;    } else {        $start_page = $active_page - $view_page;    }    if (($active_page + $view_page) >= $count['page']) {        $end_page = $count['page'] - 1;    } else {        $end_page = $active_page + $view_page;    }    //EOF-pocitadlo    //    //BOF-url - ziskani URL ke ktere se pridava strankovani    $url = $_SERVER['REQUEST_URI'];    $begin_crop = strpos($url, ":");    $end_crop = strpos($url, ".html");    if ($begin_crop < $end_crop AND $begin_crop) {        $length = $end_crop - $begin_crop;        $url = substr_replace($url, '', $begin_crop, $length);    }    $href = explode(".html", $url, 2);    $href[0] = "//" . $_SERVER['HTTP_HOST'] . $href[0];    //EOF-url    $pagination = '<ul class="pagination">';    //BOF-prvni - prvni strana    if ($active_page != 1) {        $pagination .= '<li><a href="' . $href[0] . '.html' . $href[1] . '">1</a></li>';    } else {        $pagination .= '<li class="active"><a href="#">1</a></li>';    }    //EOF-prvni    //    if ($count['page'] > 1) {        //BOF-prostredek - prostredni cast        for ($i = $start_page; $i <= $end_page; $i++) {            if ($i == $active_page) {                $pagination .= '<li class="active"><a href="#">' . $i . '</a></li>';            } else {                $pagination .= '<li><a href="' . $href[0] . ':' . $i . '.html' . $href[1] . '">' . $i . '</a></li>';            }        }        //EOF-prostredek        //    //BOF-posledni - posledni strana        if ($count['page'] != 1) {            if ($active_page == $count['page']) {                $pagination .= $separator . '<li class="active"><a href="#">Poslední (' . $count['page'] . ')</a></li>';            } else {                $pagination .= $separator . '<li><a href="' . $href[0] . ':' . $count['page'] . '.html' . $href[1] . '">Poslední (' . $count['page'] . ')</a></li>';            }        }        //EOF-posledni    }    $pagination .= "</ul>";    return $pagination;}?>